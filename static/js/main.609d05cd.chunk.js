(this["webpackJsonpwoven-images"]=this["webpackJsonpwoven-images"]||[]).push([[0],{160:function(e,t,n){},161:function(e,t,n){},162:function(e,t,n){},165:function(e,t,n){},166:function(e,t,n){},167:function(e,t,n){},168:function(e,t,n){},169:function(e,t,n){},170:function(e,t,n){},171:function(e,t,n){},172:function(e,t,n){"use strict";n.r(t);var a,r,s,i,c,o=n(8),l=n.n(o),d=n(75),u=n.n(d),h=(n(85),n(11)),T=n(10),x=n(12),f=(n(86),n(87),n(5)),E=function(e){var t={gridRow:e.row+1,gridColumn:e.col+1};return e.thread&&(t.backgroundColor=e.palette.threadPalette[e.thread.threadPaletteIndex].color),Object(f.jsx)("div",{className:"button "+(e.value?"isActive":""),style:t,onClick:e.onClickHandler})},j=(n(58),function(e){var t=function(t){e.onClickHandler(t,e.subGridType)},n=e.gridValues.map((function(n,a){return n.map((function(n,r){return Object(f.jsx)(E,{value:n,row:a,col:r,cellSize:e.cellSize,onClickHandler:t,palette:e.palette})}))}));return Object(f.jsx)("div",{className:"ButtonGrid "+(e.className?e.className:""),style:{gridTemplateRows:"repeat(1fr, ".concat(e.gridValues.length,")"),gridTemplateColumns:"repeat(1fr, ".concat(e.gridValues[0].length,")"),width:"".concat(e.gridValues[0].length*e.cellSize,"px"),height:"".concat(e.gridValues.length*e.cellSize,"px")},children:n})});!function(e){e[e.WARPTHREADTABLE=0]="WARPTHREADTABLE",e[e.WEFTTHREADTABLE=1]="WEFTTHREADTABLE",e[e.TIEUPTABLE=2]="TIEUPTABLE",e[e.HARNESSTOTHREADTABLE=3]="HARNESSTOTHREADTABLE",e[e.TREADLINGTABLE=4]="TREADLINGTABLE"}(a||(a={})),function(e){e[e.VERTICAL=0]="VERTICAL",e[e.HORIZONTAL=1]="HORIZONTAL"}(r||(r={})),function(e){e[e.SET_WARPCOUNT=0]="SET_WARPCOUNT",e[e.SET_WEFTCOUNT=1]="SET_WEFTCOUNT",e[e.SET_TREADLECOUNT=2]="SET_TREADLECOUNT",e[e.SET_HARNESSCOUNT=3]="SET_HARNESSCOUNT"}(s||(s={})),function(e){e[e.SET_HARNESSTOTHREADATTACHMENTS=0]="SET_HARNESSTOTHREADATTACHMENTS",e[e.SET_TREADLETOHARNESSATTACHMENTS=1]="SET_TREADLETOHARNESSATTACHMENTS",e[e.SET_TREADLINGINSTRUCTION=2]="SET_TREADLINGINSTRUCTION",e[e.SET_HARNESSCOUNT=3]="SET_HARNESSCOUNT",e[e.SET_TREADLECOUNT=4]="SET_TREADLECOUNT",e[e.SET_WEFTCOUNT=5]="SET_WEFTCOUNT",e[e.SET_WARPCOUNT=6]="SET_WARPCOUNT",e[e.SET_STATE=7]="SET_STATE",e[e.SET_WARPTHREADTHREADPALETTEINDEX=8]="SET_WARPTHREADTHREADPALETTEINDEX",e[e.SET_WEFTTHREADTHREADPALETTEINDEX=9]="SET_WEFTTHREADTHREADPALETTEINDEX",e[e.SET_SELECTEDTHREADDATASOURCEINDEX=10]="SET_SELECTEDTHREADDATASOURCEINDEX",e[e.SET_SELECTEDTHREADDATASOURCE=11]="SET_SELECTEDTHREADDATASOURCE",e[e.ADD_THREADDATASOURCE=12]="ADD_THREADDATASOURCE"}(i||(i={})),function(e){e[e.Orthographic=0]="Orthographic",e[e.Perspective=1]="Perspective"}(c||(c={}));var p=n(14),O=n(173).v4,m=n(31),b={harnessCount:4,treadleCount:4,warpCount:16,weftCount:16},S={threadPalette:[P("#FFFFFF"),P("#000000")],selectedIndex:0},g={id:0,threadPaletteIndex:0},A={id:0,threadPaletteIndex:1},C=function(e){return parseInt(e.substring(3,5),16)},v=function(e){return parseInt(e.substring(5,7),16)};var N=function(){return{threads:new Set}},w=function(){return{harnesses:new Set}},D=function(e,t){return{id:e,threadPaletteIndex:t}};function R(e){var t=e.data,n=t.threading,a=t.tieup,r=t.treadling,s=function(e){var t=/(\d+)/g,n=e.match(t);return n?n.map((function(e){return parseInt(e)})):[]}(a);return{warpCount:n.split(",").length,weftCount:I(r).split(",").length,treadleCount:a.split(",").length,harnessCount:Math.max.apply(Math,Object(p.a)(s))}}function I(e){var t=e.replaceAll(/(\d+)x(\d+)/g,(function(e,t,n){return(t+",").repeat(n)}));return(t=t.replaceAll(/,,/g,",")).endsWith(",")&&(t=t.substring(0,t.length-1)),t}function P(e){return{color:e}}function y(){return O()}function H(e){var t,n,a,r;return{id:y(),dimensions:e,harnesses:(r=e.harnessCount,new Array(r).fill(N()).map((function(e){return N()}))),warpThreads:(a=e.warpCount,new Array(a).fill(A).map((function(e,t){return D(t,1)}))),weftThreads:function(e){return new Array(e).fill(g).map((function(e,t){return D(t,0)}))}(e.weftCount),treadles:(n=e.treadleCount,new Array(n).fill(w()).map((function(e){return w()}))),treadlingInstructions:(t=e.weftCount,new Array(t).fill(null)),threadDataSource:{color:"#FFFFFF"},name:"untitled",indexedThreadPalette:m(S)}}var L=function(e){return JSON.stringify({id:e.id,dimensions:e.dimensions,treadles:_(e.treadles,e.harnesses),harnesses:_(e.harnesses,e.warpThreads),treadlingInstructions:e.treadlingInstructions.map((function(t){return t?e.treadles.indexOf(t):-1})),warpThreads:e.warpThreads,weftThreads:e.weftThreads,threadDataSource:e.threadDataSource,name:e.name,indexedThreadPalette:e.indexedThreadPalette})};function _(e,t){var n=[];return e.forEach((function(e,a){n.push([]),"harnesses"in e?e.harnesses.forEach((function(e){n[a].push(t.indexOf(e))})):"threads"in e&&e.threads.forEach((function(e){n[a].push(t.indexOf(e))}))})),n}n(160),n(161);var k,F=function(e){var t=Object(o.useState)(e.dimensions),n=Object(x.a)(t,2),a=n[0],r=n[1];Object(o.useEffect)((function(){r(e.dimensions)}),[e.dimensions]);var s=function(e){e.preventDefault(),r(Object(T.a)(Object(T.a)({},a),{},Object(h.a)({},e.target.name,e.target.value)))},i=Object.keys(e.dimensions).map((function(t){return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("label",{className:"InputLabel",htmlFor:t,children:(n=t,a=" ",a="undefined"===typeof a?"_":a,n.replace(/([a-z\d])([A-Z])/g,"$1"+a+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+a+"$2").toLowerCase()+" ")}),Object(f.jsx)("input",{className:"InputField",style:{display:"inline"},type:"textfield",name:t,onChange:s,placeholder:e.dimensions[t].toString()}),Object(f.jsx)("p",{className:"CurrentDimension",style:{display:"inline"},children:"\u2192 ".concat(e.dimensions[t])}),Object(f.jsx)("br",{})]});var n,a}));return Object(f.jsxs)("div",{className:"Panel",children:[Object(f.jsx)("h1",{className:"FormHeader",children:"Dimensions Editor"}),Object(f.jsx)("div",{className:"PanelContent",children:Object(f.jsxs)("form",{className:"DimensionsForm",onSubmit:function(t){t.preventDefault(),e.onDimensionsChange(a)},children:[i,Object(f.jsx)("button",{className:"ApplyBtn",type:"submit",children:"Apply"})]})})]})},U=(n(162),n(31),function(e){var t=Object(o.useState)(P("000000")),n=Object(x.a)(t,2),a=n[0],r=n[1],s=Object(o.useState)(!0),i=Object(x.a)(s,2),c=i[0],l=i[1],d=e.indexedThreadPalette.threadPalette.map((function(t,n){var a="Thread"+(n==e.indexedThreadPalette.selectedIndex?" selected":"");return Object(f.jsx)("div",{className:a,id:"thread-"+n.toString(),style:{backgroundColor:t.color},onClick:function(t){e.onSelectThreadDataSource(t.target.id.split("-")[1])}})}));return Object(f.jsxs)("div",{className:"ThreadEditorContainer Panel",children:[Object(f.jsx)("h1",{children:"Thread Palette"}),Object(f.jsxs)("div",{className:"PanelContent",children:[Object(f.jsxs)("div",{className:"ThreadContainer",children:[d,Object(f.jsx)("button",{className:"AddThreadButton",onClick:function(t){e.onAddThreadDataSource(a)},children:"+"})]}),Object(f.jsx)("div",{className:"ThreadAttributeDesigner",children:Object(f.jsx)("input",{className:"ColorPicker",type:"color",id:"ColorPicker",onChange:function(t){if(!c){var n=Object(T.a)(Object(T.a)({},e.indexedThreadPalette.threadPalette[e.indexedThreadPalette.selectedIndex]),{},{color:t.target.value});e.onSetThreadDataSource(n)}r(Object(T.a)(Object(T.a)({},a),{},{color:t.target.value}))}})}),Object(f.jsx)("button",{className:"LockBtn",onClick:function(){l(!c)},children:c?"Unlock Palette":"Lock Palette"})]})]})}),B=function(e){var t=function(t){e.onClickHandler(t,e.subGridType)},n=e.gridValues.map((function(n,a){return Object(f.jsx)(E,{styleDataSource:e.palette.threadPalette[n.threadPaletteIndex],col:e.orientation===r.HORIZONTAL?a:0,row:e.orientation===r.VERTICAL?a:0,cellSize:{width:e.cellSize.width,height:e.cellSize.height},onClickHandler:t,thread:e.gridValues[a],palette:e.palette})}));return Object(f.jsx)("div",{className:"ButtonGrid "+(e.className?e.className:""),style:{gridTemplateColumns:"repeat(1fr, ".concat(e.orientation===r.VERTICAL?e.gridValues.length:1,")"),gridTemplateRows:"repeat(1fr, ".concat(e.orientation===r.HORIZONTAL?e.gridValues.length:1,")"),width:"".concat((e.orientation===r.HORIZONTAL?e.gridValues.length:1)*e.cellSize.width,"px"),height:"".concat((e.orientation===r.VERTICAL?e.gridValues.length:1)*e.cellSize.height,"px")},children:n})},M=function(e){return Object(f.jsxs)("div",{className:"Panel",children:[Object(f.jsx)("h1",{className:"FormHeader",children:"Image Editor"}),Object(f.jsx)("div",{className:"PanelContent",children:e.children})]})},W=n(177),V=n(178),z=n(179),G=n(0),X=n(1),Z=n(4),J=n(2),$=n(3),K=n(79),q="varying vec2 vUv;\nvoid main() {\n    gl_FragColor.rgba = vec4(1.,1.,1.,1.);\n}",Q=(K.a,n(15)),Y=n(176),ee=new Uint8Array(3),te=Object(Y.a)({patternDataTexture:new G.DataTexture(ee,1,1,G.RGBFormat),repeats:1},"\nvarying vec2 vUv;\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n","varying vec2 vUv;\nuniform float repeats;\nuniform sampler2D patternDataTexture;\nvoid main() {\n    vec2 uv = vUv * repeats;\n    uv = uv - floor(uv);\n    uv.y = 1. - uv.y;\n    gl_FragColor.rgba = texture2D(patternDataTexture, uv);\n    gl_FragColor.a = 1.;\n}\n");Object(Q.b)({WeaveDisplayMaterial:te});var ne=function(e,t,n){console.log(n);for(var a,r=e*t,s=new Uint8Array(3*r),i=0;i<r;i++){var c=3*i,o=(a=n[i],parseInt(a.substring(1,3),16)),l=C(n[i]),d=v(n[i]);s[c]=o,s[c+1]=l,s[c+2]=d}return new G.DataTexture(s,e,t,G.RGBFormat)},ae=ne(2,2,["#ffffff","#000000","#ffffff","#000000"]);var re=function(e){var t=Object(o.useRef)(),n=Object(o.useRef)(),a=Object(o.useState)(ae),r=Object(x.a)(a,2),s=r[0],i=r[1],l=Object(Q.d)(),d=function(){return Math.max(e.warpThreadCount,e.weftThreadCount)},u=function(){return e.warpThreadCount/d()},h=function(){return e.weftThreadCount/d()},T=function(){return u()/h()},E=function(){return Math.atan(h()/2)*(360/Math.PI)};console.log("aspect: "+T()+"\nvFov: "+E()+"\nhFov: "+2*Math.atan(Math.tan(E()*Math.PI/180/2)*T())*180/Math.PI+"\nplaneH: "+h()+"\nplaneW: "+u()),Object(o.useEffect)((function(){i(ne(e.warpThreadCount,e.weftThreadCount,e.colorBuffer)),s.needsUpdate=!0,console.log("cam ref: ",n.current),console.log("state ref: ",l.camera),"fov"in l.camera&&(l.camera.fov=E())}),[e]);var j=e.warpThreadCount*e.unitSize,p=e.weftThreadCount*e.unitSize;return Object(f.jsxs)(f.Fragment,{children:[e.cameraMode===c.Orthographic&&Object(f.jsx)(W.a,{makeDefault:!0,args:[j/-2,j/2,p/2,p/-2,0,1e3]}),e.cameraMode===c.Perspective&&Object(f.jsx)(V.a,{makeDefault:!0,position:[0,0,1],args:[E(),T(),.1,2e3],ref:n}),Object(f.jsx)(z.a,{enablePan:!0,enableZoom:!0,enableRotate:!0}),Object(f.jsxs)("mesh",{ref:t,children:[Object(f.jsx)("planeGeometry",{attach:"geometry",args:e.cameraMode===c.Orthographic?[j,p,1,1]:[u(),h(),1,1]}),Object(f.jsx)("weaveDisplayMaterial",{attach:"material",patternDataTexture:s,repeats:e.repeats})]})]})},se=n(31);function ie(e,t){var n=se(e);switch(t.type){case i.SET_HARNESSTOTHREADATTACHMENTS:var a=n.harnesses[t.harnessID],r=n.warpThreads[t.threadID];if(a.threads.has(r))a.threads.delete(r);else{for(var s=0;s<n.harnesses.length;s++)n.harnesses[s].threads.has(r)&&n.harnesses[s].threads.delete(r);a.threads.add(r)}break;case i.SET_TREADLETOHARNESSATTACHMENTS:var c=n.treadles[t.treadleID],o=n.harnesses[t.harnessID];c.harnesses.has(o)?c.harnesses.delete(o):c.harnesses.add(o);break;case i.SET_TREADLINGINSTRUCTION:var l=n.treadles[t.treadleID];n.treadlingInstructions[t.instructionIndex]===l?n.treadlingInstructions[t.instructionIndex]=null:n.treadlingInstructions[t.instructionIndex]=l;break;case i.SET_HARNESSCOUNT:if(t.harnessCount>n.harnesses.length)for(;n.harnesses.length<t.harnessCount;)n.harnesses.unshift(N());else{var d=n.harnesses.splice(0,n.harnesses.length-t.harnessCount);n.treadles.forEach((function(e){d.forEach((function(t){e.harnesses.delete(t)}))}))}n.dimensions.harnessCount=t.harnessCount;break;case i.SET_TREADLECOUNT:if(t.treadleCount>n.treadles.length)for(;n.treadles.length<t.treadleCount;)n.treadles.push(w());else{var u=n.treadles.splice(t.treadleCount);n.treadlingInstructions.forEach((function(e){u.forEach((function(t){e=e===t?null:e}))}))}n.dimensions.treadleCount=t.treadleCount;break;case i.SET_WARPCOUNT:if(t.warpCount>e.warpThreads.length)for(;n.warpThreads.length<t.warpCount;)n.warpThreads.unshift(D(n.warpThreads.length,1));else n.warpThreads.splice(0,n.warpThreads.length-t.warpCount);n.warpThreads.forEach((function(e,t){e.id=t})),n.dimensions.warpCount=t.warpCount;break;case i.SET_WEFTCOUNT:if(t.weftCount>e.weftThreads.length)for(;n.weftThreads.length<t.weftCount;)n.weftThreads.push(D(n.weftThreads.length,0)),n.treadlingInstructions.push(null);else n.weftThreads.splice(t.weftCount),n.treadlingInstructions.splice(t.weftCount);n.dimensions.weftCount=t.weftCount;break;case i.SET_STATE:return t.state;case i.SET_WARPTHREADTHREADPALETTEINDEX:n.warpThreads[t.warpThreadID].threadPaletteIndex=n.indexedThreadPalette.selectedIndex;break;case i.SET_WEFTTHREADTHREADPALETTEINDEX:n.weftThreads[t.weftThreadID].threadPaletteIndex=n.indexedThreadPalette.selectedIndex;break;case i.SET_SELECTEDTHREADDATASOURCE:n.indexedThreadPalette.threadPalette[n.indexedThreadPalette.selectedIndex]=t.dataSource;break;case i.ADD_THREADDATASOURCE:n.indexedThreadPalette.threadPalette.push(se(t.dataSource));break;case i.SET_SELECTEDTHREADDATASOURCEINDEX:n.indexedThreadPalette.selectedIndex=t.dataSourceIndex}return n}var ce=function(e){var t=Object(o.useReducer)(ie,H(b)),n=Object(x.a)(t,2),s=n[0],c=n[1],l=Object(o.useState)(16),d=Object(x.a)(l,2),u=d[0],h=d[1],T=Object(o.useState)(1),E=Object(x.a)(T,2),p=E[0],O=E[1],m=Object(o.useState)(100),S=Object(x.a)(m,2),g=(S[0],S[1],Object(o.useState)("#000000")),A=Object(x.a)(g,2),C=(A[0],A[1],Object(o.useState)(u)),v=Object(x.a)(C,2),N=(v[0],v[1],Object(o.useState)(!0)),w=Object(x.a)(N,2);w[0],w[1];Object(o.useEffect)((function(){c({type:i.SET_STATE,state:e.currentState})}),[e.currentState]),Object(o.useEffect)((function(){e.onChange(s)}),[s]);var D,R,I,P,y=function(e,t){var n=e.target,r=parseInt(n.style.gridRow)-1,s=parseInt(n.style.gridColumn)-1;switch(t){case a.HARNESSTOTHREADTABLE:c({type:i.SET_HARNESSTOTHREADATTACHMENTS,harnessID:r,threadID:s});break;case a.TIEUPTABLE:c({type:i.SET_TREADLETOHARNESSATTACHMENTS,treadleID:s,harnessID:r});break;case a.TREADLINGTABLE:c({type:i.SET_TREADLINGINSTRUCTION,treadleID:s,instructionIndex:r});break;case a.WEFTTHREADTABLE:c({type:i.SET_WEFTTHREADTHREADPALETTEINDEX,weftThreadID:r});break;case a.WARPTHREADTABLE:c({type:i.SET_WARPTHREADTHREADPALETTEINDEX,warpThreadID:s})}};return Object(f.jsxs)("div",{className:"LoomEditorContainer",children:[Object(f.jsx)("div",{className:"LoomPane",children:Object(f.jsxs)("div",{className:"LoomContainer",style:{gridTemplateColumns:s.dimensions.warpCount*u+"px auto auto",gridTemplateRows:"auto auto "+s.dimensions.weftCount*u+"px"},children:[Object(f.jsx)(B,{subGridType:a.WARPTHREADTABLE,cellSize:{width:u,height:u/2},gridValues:s.warpThreads,orientation:r.HORIZONTAL,onClickHandler:y,palette:s.indexedThreadPalette,className:"justifyEnd"}),Object(f.jsx)("span",{className:"void",children:"\xa0"}),Object(f.jsx)("span",{className:"void",children:"\xa0"}),Object(f.jsx)(j,{subGridType:a.HARNESSTOTHREADTABLE,cellSize:u,gridValues:(I=s.warpThreads,P=s.harnesses,new Array(P.length).fill(new Array).map((function(e,t){return new Array(I.length).fill(!1).map((function(e,n){return P[t].threads.has(I[n])}))}))),onClickHandler:y,palette:s.indexedThreadPalette,className:"justifyEnd"}),Object(f.jsx)(j,{subGridType:a.TIEUPTABLE,cellSize:u,gridValues:function(e,t){return new Array(e.length).fill(new Array).map((function(n,a){return new Array(t.length).fill(!1).map((function(n,r){return t[r].harnesses.has(e[a])}))}))}(s.harnesses,s.treadles),onClickHandler:y,palette:s.indexedThreadPalette}),Object(f.jsx)("span",{className:"void",children:"\xa0"}),Object(f.jsxs)("div",{className:"CanvasContainer",children:[Object(f.jsx)(Q.a,{children:Object(f.jsx)(re,{warpThreadCount:s.dimensions.warpCount,weftThreadCount:s.dimensions.weftCount,unitSize:u,repeats:p,colorBuffer:function(e){var t=e.dimensions.warpCount,n=e.dimensions.weftCount,a=new Array(t*n).fill("#000000");return e.treadlingInstructions.forEach((function(n,r){var s=e.weftThreads[r],i=new Set;null===n||void 0===n||n.harnesses.forEach((function(e){e.threads.forEach((function(e){return i.add(e)}))})),e.warpThreads.forEach((function(n,c){a[function(e,n){return e*t+n}(r,c)]=i.has(n)?e.indexedThreadPalette.threadPalette[n.threadPaletteIndex].color:e.indexedThreadPalette.threadPalette[s.threadPaletteIndex].color}))})),console.log(a),a}(s),cameraMode:e.cameraMode})}),Object(f.jsx)("div",{id:"CanvasResizer",onMouseDown:function(e){return console.log("mdown",e)},onMouseMove:function(e){return console.log("mmove",e)},onMouseUp:function(e){return console.log("mup",e)}})]}),Object(f.jsx)(j,{subGridType:a.TREADLINGTABLE,cellSize:u,gridValues:(D=s.treadles,R=s.treadlingInstructions,new Array(R.length).fill(new Array).map((function(e,t){return new Array(D.length).fill(!1).map((function(e,n){return R[t]===D[n]}))}))),onClickHandler:y,palette:s.indexedThreadPalette}),Object(f.jsx)(B,{subGridType:a.WEFTTHREADTABLE,cellSize:{width:u/2,height:u},gridValues:s.weftThreads,orientation:r.VERTICAL,onClickHandler:y,palette:s.indexedThreadPalette})]})}),Object(f.jsxs)("div",{className:"EditorPanes",children:[Object(f.jsx)(F,{dimensions:s.dimensions,onDimensionsChange:function(e){c({type:i.SET_HARNESSCOUNT,harnessCount:e.harnessCount}),c({type:i.SET_TREADLECOUNT,treadleCount:e.treadleCount}),c({type:i.SET_WARPCOUNT,warpCount:e.warpCount}),c({type:i.SET_WEFTCOUNT,weftCount:e.weftCount})}}),Object(f.jsx)(M,{children:Object(f.jsxs)("form",{className:"ImageEditorForm",children:[Object(f.jsx)("label",{style:{verticalAlign:"top"},htmlFor:"cellSize",children:"cell size "}),Object(f.jsx)("input",{type:"range",min:"2",max:"16",defaultValue:"16",id:"cellSizeSlider",onChange:function(e){var t=e.target;return h(parseInt(t.value))}}),Object(f.jsx)("br",{}),Object(f.jsx)("label",{style:{verticalAlign:"top"},htmlFor:"scaleSlider",children:"pattern scale "}),Object(f.jsx)("input",{type:"range",min:"1",max:"16",defaultValue:"1",id:"scaleSlider",onChange:function(e){var t=e.target;return O(parseInt(t.value))}}),Object(f.jsx)("br",{})]})}),Object(f.jsx)(U,{onSelectThreadDataSource:function(e){c({type:i.SET_SELECTEDTHREADDATASOURCEINDEX,dataSourceIndex:e})},onSetThreadDataSource:function(e){c({type:i.SET_SELECTEDTHREADDATASOURCE,dataSource:e})},onAddThreadDataSource:function(e){c({type:i.ADD_THREADDATASOURCE,dataSource:e})},indexedThreadPalette:s.indexedThreadPalette})]})]})},oe=(n(165),function(e){return Object(f.jsxs)("div",{className:"ToolBarMenu",children:[Object(f.jsx)("div",{className:"ToolBarMenuName",children:e.name}),Object(f.jsx)("div",{className:"ToolBarMenuChildren",children:e.children})]})}),le=(n(166),function(e){return Object(f.jsxs)("div",{onClick:e.onClick,className:e.className?e.className:"ToolBarMenuNode",children:[Object(f.jsx)("span",{children:e.text}),Object(f.jsx)("div",{className:"ToolBarMenuSubNodes "+(e.children?"populated":""),children:e.children})]})}),de="1+4,1+2,2+3,3+4",ue=[{name:"Basic Twill",data:{threading:"1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4",tieup:"1+4,1+2,2+3,3+4",treadling:"1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4"}},{name:"Periwinkle",data:{threading:"3,2,1,4,3,2,1,4,3,4,3,2,3,2,1,4,3,4,1,2,3,2,3,4,3,4,1,2",tieup:"1+4,1+2,2+3,3+4",treadling:"3,2,1,4x3,3x3,2,1,4x2,1,2,3x3,4x3,1,2,3"}},{name:"Diadem",data:{threading:"4,1,2,3,4,1,2,3,4,1,2,3,2,3,2,1,4,3,4,3,4,1,2,1,2,1,4,3,4,3,4,1,2,3,2,3,2,1,4,3,2,1,4,3,2,1,4,1",tieup:"1+4,1+2,2+3,3+4",treadling:"3x2,4,1,2,3,4,1,2,3,4,1x4,4,3,2x4,3,4x4,3,2x4,3,4,1x4,4,3,2,1,4,3,2,1,4,3x2"}},{name:"Rings and Chains",data:{threading:"1,2,3,4,1,2,3,4,1,2,3,4,1,4,1,4,3,4,3,2,3,2,1,2,1,4,1,2,1,4,1,2,1,4,1,2,1,4,1,2,1,4,1,2,1,4,1,2,1,2,3,2,3,4,3,4,1,4,1,4,3,2,1,4,1,2,3,4",tieup:"1+4,1+2,2+3,3+4",treadling:"1,2,3,4,1x4,4x3,3x3,2x3,1x2,2x2,1x2,2x2,1x2,2x2,1x2,2x2,1x2,2x2,1x2,2x3,3x3,4x3,1x4,4,3,2,1"}},{name:"Wheel of Fortune",data:{threading:"1,2,3,4,1,2,1,2,3,2,3,4,3,4,1,4,3,4,1,4,3,4,3,2,3,2,1,2,1,4,3,2,1,4,3,2,1,4,3,2,3,2,1,2,1,4,1,4,3,4,1,4,3,4,1,4,1,2,1,2,3,2,3,4,1,2,3,4",tieup:"1+4,1+2,2+3,3+4",treadling:"2,3,4,1,2x3,3x3,4x3,1x2,4x2,1x2,4x3,3x3,2x3,1,4,3,2,1,4,3,2,1,4,3x3,2x3,1x3,4x2,1x2,4x2,1x3,2x3,3x3,4,1,2,3,4,1"}},{name:"Chariot Wheel No. 3",data:{threading:"4,3,2,1,4,3,2,3,4,3,2,3,4,1,4,1,4,1,2,1,2,1,4,1,2,1,4,1,2,1,2,1,4,1,4,1,4,3,2,3,4,3,2,3,4,1,2,3",tieup:"1+4,1+2,2+3,3+4",treadling:"4,3,2,1,4,3x2,4x2,3x2,4,1x5,2x4,1x2,2x2,1x2,2x4,1x5,4,3x2,4x2,3x2,4,1,2,3,4"}},{name:"Chariot Wheel No. 3 Alt",data:{threading:"4,3,2,1,4,3,2,3,4,3,2,3,4,1,4,1,4,1,2,1,2,1,4,1,2,1,4,1,2,1,2,1,4,1,4,1,4,3,2,3,4,3,2,3,4,1,2,3",tieup:"1+4,1+2,2+3,3+4",treadling:"3,4,1,2,3,4x2,3x2,4x2,3,2x5,1x4,2x2,1x2,2x2,1x4,2x5,3,4x2,3x2,4x2,3,2,1,4,3"}},{name:"Church Windows",data:{threading:"3,2,1,4,3,4,3,4,1,4,1,2,1,4,1,4,3,4,3,4,1,2,3,2,1,2,3,2,1,2,3,2,1,2,3,2,1,2,3,2,1,2,3,2,1,4,3,4,3,4,1,4,1,2,1,4,1,4,3,4,3,4,2,1",tieup:"1+4,1+2,2+3,3+4",treadling:"3,2,1,4x4,1x3,2x2,1x3,4x4,1,2,3x2,2x2,3x2,2x2,3x2,2x2,3x2,2x2,3x2,2x2,3x2,2,1,4x4,1x3,2x2,1x3,4x4,1,2,3"}},{name:"Cambridge Beauty",data:{threading:"2,3,4,1,4,1,4,1,4,3,4,3,4,3,2,3,2,3,2,1,2,1,2,1,2,3,4,3,2,1,2,3,4,3,2,1,2,3,4,3,2,1,2,3,4,3,2,1,2,1,2,1,2,3,2,3,2,3,4,3,4,3,4,1,4,1,4,1,4,3",tieup:"1+4,1+2,2+3,3+4",treadling:"3,4,1x6,4x5,3x5,2x6,3,4x2,3,2x2,3,4x2,3,2x2,3,4x2,3,2x2,3,4x2,3,2x2,3,4x2,3,2x6,3x5,4x5,1x6,4,3"}},{name:"Star of Bethlehem",data:{threading:"2,3,4,1,2,3,4,1,2,3,4,1,2,1,2,3,2,3,4,3,4,1,4,1,2,3,4,1,4,3,2,1,4,1,4,3,4,3,2,3,2,1,2,1,4,3,2,1",tieup:"1+4,1+2,2+3,3+4",treadling:"2,3,4,1,2,3,4,1,2,3,4,1,2x3,3x3,4x3,1x3,1,2,3,4,1x2,4,3,2,1x3,4x3,3x3,2x3,1,4,3,2"}},{name:"Maltese Cross",data:{threading:"1,2,3,4,1,2,1,4,1,4,3,4,3,2,3,2,1,2,1,4,1,2,1,4,1,2,1,2,3,2,3,4,3,4,1,4,1,2,1,4,3,2",tieup:"1+4,1+2,2+3,3+4",treadling:"2,1,4,3,2,1,4,3,2x2,3x3,4x3,1x3,2x3,3x2,2x2,3x2,2x3,1x3,4x3,3x3,2x2,3,4,1,2"}},{name:"Orange Peel A",data:{threading:"1,2,3,4,1,2,3,2,3,4,3,4,1,4,1,2,1,4,1,2,1,4,1,2,1,4,1,4,3,4,3,2,3,2,1,4,3,2",tieup:de,treadling:"2,3,4,1,2,3x3,4x3,1x3,2x2,1x2,2x2,1x2,2x2,1x3,4x3,3x3,2,1,4,3,2"}},{name:"Orange Peel B",data:{threading:"1,2,3,4,1,2,3,2,3,4,3,4,1,4,1,2,1,4,1,2,1,4,1,2,1,4,1,4,3,4,3,2,3,2,1,4,3,2",tieup:de,treadling:"1,4,3,2,1,4x3,3x3,2x3,1x2,2x2,1x2,2x2,1x2,2x3,3x3,4x3,1,2,3,4,1"}},{name:"Lovers Knot No. 1",data:{threading:"4,3,2,1,2,1,2,3,4,3,4,1,4,3,4,1,4,3,4,3,2,1,2,1,2,3,4,1,2,3,2,1,4,3,2,1,2,3,4,1,2,3,2,1",tieup:de,treadling:"4,3,2x4,3,4x3,1x2,4x2,1x2,4x3,3,2x4,3,4,1,2,3x2,2,1,4,3,2x2,3,4,1,2,3x2,2,1"}},{name:"Lovers Knot No. 2",data:{threading:"3,2,1,4,3,2,3,2,1,2,3,2,1,2,3,2,3,4,3,4,3,4,1,4,1,4,1,4,3,4,1,4,3,4,1,4,1,4,1,4,3,4,3,4,3,2,3,2,1,2,3,2,1,2,3,2,3,4,1,2,3,2,1,4,3,2,1,2,3,4,1,2",tieup:de,treadling:"2,3,4,1,2,3x2,2,1,4,3x3,2x2,3x2,2x2,3x3,4x5,1x6,4x2,1x2,4x2,1x6,4x5,3x3,2x2,3x2,2x2,3x3,4,1,2,3x2,2,1,4,3,2"}},{name:"Cross of Tennessee",data:{threading:"4,3,2,1,4,3,2,1,4,1,4,1,4,3,4,3,2,1,2,3,2,1,2,3,2,1,2,3,2,1,2,3,2,1,2,3,2,1,2,3,4,3,4,1,4,1,4,1,2,3,4,1,2,3,4,1",tieup:de,treadling:"1,4,3,2,1,4,3,2,1x5,4x3,3,2x2,3x2,2x2,3x2,2x2,3x2,2x2,3x2,2x2,3x2,2x2,3,4x3,1x5,2,3,4,1,2,3,4,1"}}],he=function(e){var t,n=Object.keys(e.saveStateDict).map((function(t){return n=t,Object(f.jsx)(le,{className:"ToolBarMenuSubNode",text:e.saveStateNames[n],onClick:function(){return e.onLoad(n)}});var n}));return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(oe,{name:"File",children:[Object(f.jsx)(le,{text:"Create New",onClick:e.onCreateNew}),Object(f.jsx)(le,{text:"Save",onClick:e.onSave}),Object(f.jsx)(le,{text:"Save As",onClick:e.onSaveAs}),Object(f.jsx)(le,{text:"Load",children:Object(p.a)(n)}),Object(f.jsx)(le,{text:"Load Preset",children:Object(p.a)((t=ue,t.map((function(e){return function(e){var t=H(R(e)),n=e.data,a=n.threading,r=n.tieup,s=n.treadling;return a.split(",").reverse().map((function(e){return parseInt(e)})).forEach((function(e,n){var a=t.harnesses.length-e;t.harnesses[a].threads.add(t.warpThreads[n])})),r.split(",").map((function(e){return e.split("+").map((function(e){return parseInt(e)}))})).forEach((function(e,n){e.forEach((function(e){var a=t.harnesses.length-1-(e-1);t.treadles[n].harnesses.add(t.harnesses[a])}))})),I(s).split(",").map((function(e){return parseInt(e)})).forEach((function(e,n){t.treadlingInstructions[n]=t.treadles[e-1]})),t.name=e.name,t}(e)})).map((function(t,n){return function(t){return Object(f.jsx)(le,{className:"ToolBarMenuSubNode",text:t.name,onClick:function(){return e.onLoadPreset(t)}})}(t)}))))})]}),Object(f.jsx)(oe,{name:"View",children:Object(f.jsxs)(le,{text:"Dimensions",children:[Object(f.jsx)(le,{text:"2D",onClick:function(){return e.onDimensionChange(c.Orthographic)}}),Object(f.jsx)(le,{text:"3D",onClick:function(){return e.onDimensionChange(c.Perspective)}})]})})]})};var Te=function(e,t){var n=function(){if("undefined"===typeof window)return t;try{var n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(a){return console.warn("Error reading localStorage key \u201c".concat(e,"\u201d:"),a),t}},a=Object(o.useState)(n),r=Object(x.a)(a,2),s=r[0],i=r[1];return Object(o.useEffect)((function(){i(n())}),[]),Object(o.useEffect)((function(){var e=function(){i(n())};return window.addEventListener("storage",e),window.addEventListener("local-storage",e),function(){window.removeEventListener("storage",e),window.removeEventListener("local-storage",e)}}),[]),[s,function(t){"undefined"==typeof window&&console.warn("Tried setting localStorage key \u201c".concat(e,"\u201d even though environment is not a client"));try{var n=t instanceof Function?t(s):t;window.localStorage.setItem(e,JSON.stringify(n)),i(n),window.dispatchEvent(new Event("local-storage"))}catch(a){console.warn("Error setting localStorage key \u201c".concat(e,"\u201d:"),a)}}]},xe=(n(167),function(e){return Object(f.jsx)("div",{className:"DialogContainer",children:Object(f.jsx)("div",{className:"DialogBox",children:e.children})})}),fe=n(31),Ee=function(){var e=Te("saveStates",{}),t=Object(x.a)(e,2),n=t[0],a=t[1],r=Te("saveStateNames",{}),s=Object(x.a)(r,2),i=s[0],l=s[1],d=H(b),u=Object(o.useState)(d),E=Object(x.a)(u,2),j=E[0],p=E[1],O=Object(o.useState)(!1),m=Object(x.a)(O,2),S=m[0],g=m[1],A=Object(o.useState)(),C=Object(x.a)(A,2),v=C[0],D=C[1],R=Object(o.useState)(j),I=Object(x.a)(R,2),P=I[0],_=I[1],k=Object(o.useState)(c.Orthographic),F=Object(x.a)(k,2),U=F[0],B=F[1],M=function(){g(!1)},W=Object(f.jsx)(xe,{children:Object(f.jsxs)("form",{className:"w100",onSubmit:function(e){g(!1),e.preventDefault();var t=y(),r=fe(P),s=e.target.newFileName.value;r.name=s,r.id=t;var c=L(P);a(Object(T.a)(Object(T.a)({},n),{},Object(h.a)({},t,c))),l(Object(T.a)(Object(T.a)({},i),{},Object(h.a)({},r.id,r.name))),p(r)},children:[Object(f.jsxs)("div",{className:"w100",children:[Object(f.jsx)("span",{children:"New file name:"}),Object(f.jsx)("input",{type:"text",name:"newFileName",className:"underline w100",placeholder:P.name})]}),Object(f.jsxs)("div",{className:"w100",style:{marginTop:"1em"},children:[Object(f.jsx)("button",{className:"cancelBtn",style:{width:"50%"},onClick:M,children:"Cancel"}),Object(f.jsx)("button",{type:"submit",className:"saveBtn",style:{width:"50%"},children:"Save"})]})]})}),V=Object(f.jsx)(xe,{children:Object(f.jsxs)("form",{className:"w100",onSubmit:function(e){g(!1),e.preventDefault();var t=H(b),n=e.target.fileName.value;t.name=n,p(t)},children:[Object(f.jsxs)("div",{className:"w100",children:[Object(f.jsx)("span",{children:"File name:"}),Object(f.jsx)("input",{type:"text",name:"fileName",className:"underline w100",placeholder:"untitled"})]}),Object(f.jsxs)("div",{className:"w100",style:{marginTop:"1em"},children:[Object(f.jsx)("button",{className:"cancelBtn",style:{width:"50%"},onClick:M,children:"Cancel"}),Object(f.jsx)("button",{type:"submit",className:"saveBtn",style:{width:"50%"},children:"Create"})]})]})});return Object(f.jsxs)("div",{className:"Container",children:[Object(f.jsx)(he,{saveStateDict:n,saveStateNames:i,onCreateNew:function(){D(V),g(!0)},onLoad:function(e){var t=function(e){var t=JSON.parse(e);return t.harnesses=t.harnesses.map((function(e){var n=N();return e.forEach((function(e){n.threads.add(t.warpThreads[e])})),n})),t.treadles=t.treadles.map((function(e){var n=w();return e.forEach((function(e){n.harnesses.add(t.harnesses[e])})),n})),t.treadlingInstructions=t.treadlingInstructions.map((function(e){return t.treadles[e]})),t}(n[e]);p(t)},onLoadPreset:function(e){p(e)},onSaveAs:function(){D(W),g(!0)},onSave:function(){var e=L(P);a(Object(T.a)(Object(T.a)({},n),{},Object(h.a)({},P.id,e))),l(Object(T.a)(Object(T.a)({},i),{},Object(h.a)({},P.id,P.name)))},onDimensionChange:function(e){return B(e)}}),Object(f.jsx)(ce,{currentState:j,onChange:function(e){_(e)},cameraMode:U}),S&&v]})};n(168),n(169),n(170),n(171);var je=function(){return Object(f.jsx)("div",{className:"App",children:Object(f.jsx)(Ee,{})})},pe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,180)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),s(e),i(e)}))};u.a.render(Object(f.jsx)(l.a.StrictMode,{children:Object(f.jsx)(je,{})}),document.getElementById("root")),pe()},58:function(e,t,n){},85:function(e,t,n){},86:function(e,t,n){},87:function(e,t,n){}},[[172,1,2]]]);
//# sourceMappingURL=main.609d05cd.chunk.js.map